<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø¯Ù† - Libya FPL</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* Cities League specific overrides */
        .team-captains {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-top: 0.25rem;
        }
        
        .captain-tag {
            font-size: 0.7rem;
            color: #f5c842;
            background: rgba(245, 200, 66, 0.1);
            padding: 0.1rem 0.4rem;
            border-radius: 4px;
        }
        
        /* Rank change arrows */
        .rank-up {
            color: #22c55e;
            font-weight: 700;
            font-size: 0.8rem;
        }
        
        .rank-down {
            color: #ef4444;
            font-weight: 700;
            font-size: 0.8rem;
        }
        
        .rank-same {
            color: #888;
            font-size: 0.8rem;
        }
        
        .rank-change-cell {
            text-align: center;
            min-width: 50px;
        }
        
        /* Row highlighting for win/loss */
        .row-win {
            background: rgba(34, 197, 94, 0.08) !important;
        }
        
        .row-loss {
            background: rgba(239, 68, 68, 0.08) !important;
        }
        
        /* Standings captains column */
        .standings-table .captains-cell {
            font-size: 0.75rem;
            color: #f5c842;
            max-width: 200px;
            text-align: right;
        }
        
        /* Fixtures captains column */
        .match-captains-cell {
            font-size: 0.75rem;
            color: #f5c842;
            min-width: 180px;
        }
        
        .captains-split {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            justify-content: center;
        }
        
        .cap-team1, .cap-team2 {
            flex: 1;
            text-align: center;
        }
        
        .cap-vs {
            color: #666;
            font-size: 0.8rem;
        }
        
        .captains-header {
            min-width: 180px;
        }
        
        /* Mobile captains row */
        .fixture-captains-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 0.5rem;
            font-size: 0.7rem;
            color: #f5c842;
            background: rgba(245, 200, 66, 0.05);
            border-radius: 0 0 8px 8px;
        }
        
        .cap-side {
            flex: 1;
            text-align: center;
        }
        
        .cap-divider {
            padding: 0 0.5rem;
            font-size: 0.8rem;
        }
        
        /* Stats row at top */
        .stats-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .stat-pill {
            background: var(--bg-card);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            border: 1px solid var(--border-color);
        }
        
        .stat-pill .value {
            font-weight: 700;
            color: var(--primary-purple);
        }
        
        /* Mobile standings change column */
        .msh-change, .ms-change {
            width: 40px;
            text-align: center;
        }
        
        /* Mobile adjustments */
        @media (max-width: 768px) {
            .captains-cell, .match-captains-cell, .captains-header {
                display: none;
            }
            
            .team-captains {
                font-size: 0.65rem;
            }
            
            .fixture-captains-row {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo">
                <img src="{{ url_for('static', filename='cities_logo.png') }}" alt="Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø¯Ù†" class="logo-img">
                <div class="logo-text">
                    <span class="logo-title">Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø¯Ù†</span>
                    <span class="logo-subtitle">CITIES LEAGUE</span>
                </div>
            </a>
            <div class="gameweek-info">
                <span class="gw-label">Ø§Ù„Ø¬ÙˆÙ„Ø©</span>
                <span class="gw-number">{{ data.gameweek or '-' }}</span>
                {% if data.is_live %}
                    <span class="status-badge live">ğŸ”´ Ù…Ø¨Ø§Ø´Ø±</span>
                {% endif %}
                <button class="refresh-btn" onclick="location.reload()">ğŸ”„</button>
                <a href="/" class="stats-link">ğŸ </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-pill">
                <span>ğŸ™ï¸</span>
                <span class="value">{{ data.total_teams or 20 }}</span>
                <span>ÙØ±ÙŠÙ‚</span>
            </div>
            <div class="stat-pill">
                <span>ğŸ‘¥</span>
                <span class="value">{{ (data.total_teams or 20) * 3 }}</span>
                <span>Ù…Ø¯ÙŠØ±</span>
            </div>
            <div class="stat-pill">
                <span>âš”ï¸</span>
                <span class="value">{{ data.matches|length if data.matches else 0 }}</span>
                <span>Ù…Ø¨Ø§Ø±Ø§Ø©</span>
            </div>
            <div class="stat-pill">
                <span>ğŸ•</span>
                <span>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: {{ data.last_updated or '-' }}</span>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Fixtures Section (Right side in RTL) -->
            <section class="fixtures-section">
                <h2 class="section-title">
                    âš”ï¸ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ø¬ÙˆÙ„Ø©
                    {% if data.is_live %}
                        <span class="live-badge">ğŸ”´ Ù…Ø¨Ø§Ø´Ø±</span>
                    {% endif %}
                </h2>
                
                {% if data.matches %}
                    <!-- Desktop Table View -->
                    <div class="fixtures-table-container desktop-only">
                        <table class="fixtures-table">
                            <thead>
                                <tr>
                                    <th>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</th>
                                    <th>Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                                    <th>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</th>
                                    <th>Ø§Ù„ÙØ§Ø±Ù‚</th>
                                    <th class="captains-header">Ø§Ù„ÙƒØ¨Ø§ØªÙ†</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for match in data.matches %}
                                <tr class="fixture-row">
                                    <td class="team-cell {% if match.points_1 > match.points_2 %}winner{% endif %}">
                                        <div class="team-info-cell">
                                            <span class="team-name">
                                                {% if match.points_1 > match.points_2 %}<span class="winner-icon">âœ“</span>{% endif %}
                                                {{ match.team_1 }}
                                            </span>
                                        </div>
                                    </td>
                                    <td class="score-cell">
                                        <span class="score {% if match.points_1 > match.points_2 %}score-win{% endif %}">{{ match.points_1 }}</span>
                                        <span class="vs">-</span>
                                        <span class="score {% if match.points_2 > match.points_1 %}score-win{% endif %}">{{ match.points_2 }}</span>
                                    </td>
                                    <td class="team-cell {% if match.points_2 > match.points_1 %}winner{% endif %}">
                                        <div class="team-info-cell">
                                            <span class="team-name">
                                                {% if match.points_2 > match.points_1 %}<span class="winner-icon">âœ“</span>{% endif %}
                                                {{ match.team_2 }}
                                            </span>
                                        </div>
                                    </td>
                                    <td class="diff-cell">
                                        <span class="diff-badge">{{ (match.points_1 - match.points_2)|abs }}</span>
                                    </td>
                                    <td class="match-captains-cell">
                                        <div class="captains-split">
                                            <span class="cap-team1">{{ match.captains_1|join(' â€¢ ') }}</span>
                                            <span class="cap-vs">|</span>
                                            <span class="cap-team2">{{ match.captains_2|join(' â€¢ ') }}</span>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Mobile Cards View -->
                    <div class="mobile-fixtures mobile-only">
                        {% for match in data.matches %}
                        <div class="fixture-card">
                            <div class="fixture-card-main">
                                <!-- Team 1 -->
                                <div class="fixture-team {% if match.points_1 > match.points_2 %}winner{% endif %}">
                                    <span class="fixture-team-name">
                                        {% if match.points_1 > match.points_2 %}âœ“ {% endif %}{{ match.team_1 }}
                                    </span>
                                </div>
                                
                                <!-- Score -->
                                <div class="fixture-score-block">
                                    <div class="fixture-scores">
                                        <span class="fixture-pts {% if match.points_1 > match.points_2 %}winning{% endif %}">{{ match.points_1 }}</span>
                                        <span class="fixture-separator">-</span>
                                        <span class="fixture-pts {% if match.points_2 > match.points_1 %}winning{% endif %}">{{ match.points_2 }}</span>
                                    </div>
                                    <div class="fixture-diff">
                                        <span class="fixture-diff-badge">{{ (match.points_1 - match.points_2)|abs }}</span>
                                    </div>
                                </div>
                                
                                <!-- Team 2 -->
                                <div class="fixture-team {% if match.points_2 > match.points_1 %}winner{% endif %}">
                                    <span class="fixture-team-name">
                                        {% if match.points_2 > match.points_1 %}âœ“ {% endif %}{{ match.team_2 }}
                                    </span>
                                </div>
                            </div>
                            <!-- Captains row at bottom -->
                            <div class="fixture-captains-row">
                                <span class="cap-side">{{ match.captains_1|join(' â€¢ ') }}</span>
                                <span class="cap-divider">ğŸ‘‘</span>
                                <span class="cap-side">{{ match.captains_2|join(' â€¢ ') }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª</div>
                {% endif %}
            </section>

            <!-- Standings Section (Left side in RTL) -->
            <section class="standings-section">
                <h2 class="section-title">
                    ğŸ† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¯ÙˆØ±ÙŠ
                    {% if data.is_live %}
                        <span class="live-badge">ğŸ”´ Ù…Ø¨Ø§Ø´Ø±</span>
                    {% endif %}
                </h2>
                
                {% if data.standings %}
                    <!-- Desktop Table -->
                    <div class="standings-table-container desktop-only">
                        <table class="standings-table">
                            <thead>
                                <tr>
                                    <th>Ù…</th>
                                    <th>Ø§Ù„ÙØ±ÙŠÙ‚</th>
                                    <th>Ù†.Ø¬</th>
                                    <th>Ù†.Ø¯</th>
                                    <th>+/-</th>
                                    <th class="captains-cell">Ø§Ù„ÙƒØ¨Ø§ØªÙ†</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in data.standings %}
                                <tr class="{% if loop.index <= 3 %}top-three{% endif %} {% if team.result == 'W' %}row-win{% elif team.result == 'L' %}row-loss{% endif %}">
                                    <td class="rank-cell">
                                        {% if loop.index == 1 %}
                                            <span class="rank-badge gold">ğŸ¥‡</span>
                                        {% elif loop.index == 2 %}
                                            <span class="rank-badge silver">ğŸ¥ˆ</span>
                                        {% elif loop.index == 3 %}
                                            <span class="rank-badge bronze">ğŸ¥‰</span>
                                        {% else %}
                                            {{ team.rank }}
                                        {% endif %}
                                    </td>
                                    <td class="name-cell">{{ team.team_name }}</td>
                                    <td class="gw-points-cell">{{ team.live_gw_points }}</td>
                                    <td class="league-points-cell">{{ team.league_points }}</td>
                                    <td class="rank-change-cell">
                                        {% if team.rank_change and team.rank_change > 0 %}
                                            <span class="rank-up">â–²{{ team.rank_change }}</span>
                                        {% elif team.rank_change and team.rank_change < 0 %}
                                            <span class="rank-down">â–¼{{ team.rank_change|abs }}</span>
                                        {% else %}
                                            <span class="rank-same">-</span>
                                        {% endif %}
                                    </td>
                                    <td class="captains-cell">{{ team.captains|join(' â€¢ ') }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Mobile Standings -->
                    <div class="mobile-standings mobile-only">
                        <div class="mobile-standings-header">
                            <span class="msh-rank">Ù…</span>
                            <span class="msh-name">Ø§Ù„ÙØ±ÙŠÙ‚</span>
                            <span class="msh-gw">Ù†.Ø¬</span>
                            <span class="msh-lp">Ù†.Ø¯</span>
                            <span class="msh-change">+/-</span>
                        </div>
                        {% for team in data.standings %}
                        <div class="mobile-standing-row {% if loop.index <= 3 %}top-three{% endif %} {% if team.result == 'W' %}row-win{% elif team.result == 'L' %}row-loss{% endif %}">
                            <div class="mobile-standing-main">
                                <span class="ms-rank">
                                    {% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}{{ team.rank }}{% endif %}
                                </span>
                                <span class="ms-name">{{ team.team_name }}</span>
                                <span class="ms-gw">{{ team.live_gw_points }}</span>
                                <span class="ms-lp">{{ team.league_points }}</span>
                                <span class="ms-change">
                                    {% if team.rank_change and team.rank_change > 0 %}
                                        <span class="rank-up">â–²{{ team.rank_change }}</span>
                                    {% elif team.rank_change and team.rank_change < 0 %}
                                        <span class="rank-down">â–¼{{ team.rank_change|abs }}</span>
                                    {% else %}
                                        <span class="rank-same">-</span>
                                    {% endif %}
                                </span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-data">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
                {% endif %}
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer style="text-align: center; padding: 2rem; color: #888; font-size: 0.8rem;">
        <p>Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…Ø¯Ù† - Ø¨Ø·ÙˆÙ„Ø© Ø¹Ø´Ø§Ù‚ Ø§Ù„ÙØ§Ù†ØªØ§Ø²ÙŠ ÙÙŠ Ù„ÙŠØ¨ÙŠØ§</p>
        <p style="margin-top: 0.25rem; color: #666;">ÙƒÙ„ ÙØ±ÙŠÙ‚ ÙŠØªÙƒÙˆÙ† Ù…Ù† 3 Ù…Ø¯ÙŠØ±ÙŠÙ†</p>
    </footer>
</body>
</html>
